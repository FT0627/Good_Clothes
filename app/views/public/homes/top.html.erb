<div>
  <%= flash[:notice] %>
</div>

<div class="container text-center">
  <div class="row ">
    <div class="col-lg-3 side-bar">
      <h3 class="my-3">タグ</h3>
      <% @tags.each do |tag| %>
        <% if tag.items.present? %>
        <div class="row d-inline-flex">
          <div class="col-lg-4">
            <i class="fa-solid fa-hashtag d-inline-flex">
              <%= link_to tag.name, root_path(tag_id: tag.id) %>
              <%= "(#{tag.items.count})" %>
            </i>
          </div>
        </div>
        <% end %>
        <!--タグが全て残った状態-->
      <% end %>
    </div>
    <div class="col-lg-9">
      <h1 class="my-4">投稿一覧</h1>
      <div class="row">
        <% @items.each do |item| %>
        <div class="col-lg-3">
        <div class="card">
            <div class="card-header">
              <%= image_tag item.user.get_profile_image(50,50), class: "rounded-circle" %>
              <%= link_to item.user.name, user_path(item.user) %>
            </div>
            <%= link_to item_path(item) do %>
            <%= image_tag item.item_images[0], size: "180x240", class: "card-img-top" %>
            <% end %>
            <div class="card-body">
              <%= link_to item.shop.name, shop_path(item.shop.id) %>
              <div id="star_<%= item.id %>"></div>
                <script>
                  $(document).on('turbolinks:load', function(){
                    let elem = document.querySelector('#star_<%= item.id %>');
                    if (elem == null) return;

                    elem.innerHTML = "";
                    let opt = {
                      starOn: "<%= asset_path('star-on.png') %>",
                      starOff: "<%= asset_path('star-off.png') %>",
                      starHalf: "<%= asset_path('star-half.png') %>",
                      score: "<%= item.star %>",
                      readOnly: true,
                    };
                    raty(elem, opt);
                  });
                </script>
            </div>
        </div>
        </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
